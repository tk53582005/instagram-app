<div style="max-width: 935px; margin: 0 auto; padding: 30px 20px;">
  <div style="background: white; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); padding: 40px;">
    <div style="display: flex; align-items: center; gap: 80px; margin-bottom: 40px;">
      <!-- プロフィール画像 -->
      <div>
        <%= image_tag @user.profile_image_url, 
                      style: "width: 150px; height: 150px; border-radius: 50%; object-fit: cover; border: 1px solid #dbdbdb;",
                      alt: "#{@user.username}のプロフィール画像" %>
      </div>

      <!-- プロフィール情報 -->
      <div style="flex: 1;">
        <div style="display: flex; align-items: center; gap: 20px; margin-bottom: 20px;">
          <h1 style="font-size: 28px; font-weight: 300; margin: 0;"><%= @user.username %></h1>
          
          <!-- フォローボタンまたはプロフィール編集ボタン -->
          <% if @user == current_user %>
            <%= link_to "プロフィールを編集", 
                        edit_profile_path(@user.username), 
                        style: "padding: 7px 16px; background: #efefef; border: 1px solid #dbdbdb; border-radius: 8px; text-decoration: none; color: #262626; font-size: 14px; font-weight: 600;" %>
          <% else %>
            <div id="follow-button-<%= @user.id %>">
              <%= render 'follows/follow_button', user: @user %>
            </div>
          <% end %>
        </div>
        
        <% if @user.name.present? %>
          <p style="font-weight: 600; margin: 10px 0;"><%= @user.name %></p>
        <% end %>

        <div style="margin-top: 20px;">
          <span style="margin-right: 30px;">
            <strong><%= @posts.count %></strong> 投稿
          </span>
          <span style="margin-right: 30px;">
            <%= link_to profile_followers_path(@user.username), 
                        style: "text-decoration: none; color: #262626;" do %>
              <strong id="followers-count-<%= @user.id %>"><%= @user.followers.count %></strong> フォロワー
            <% end %>
          </span>
          <span>
            <%= link_to profile_followings_path(@user.username), 
                        style: "text-decoration: none; color: #262626;" do %>
              <strong><%= @user.followings.count %></strong> フォロー中
            <% end %>
          </span>
        </div>
      </div>
    </div>

    <hr style="border: none; border-top: 1px solid #dbdbdb; margin: 40px 0;">

    <!-- 投稿一覧 -->
    <% if @posts.any? %>
      <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 28px;">
        <% @posts.each do |post| %>
          <div style="position: relative; padding-bottom: 100%; overflow: hidden;">
            <%= link_to post_path(post), style: "position: absolute; top: 0; left: 0; width: 100%; height: 100%;" do %>
              <% if post.images.attached? %>
                <%= image_tag post.images.first, 
                              style: "width: 100%; height: 100%; object-fit: cover;",
                              alt: "投稿画像" %>
              <% end %>
            <% end %>
          </div>
        <% end %>
      </div>
    <% else %>
      <div style="text-align: center; padding: 60px 0;">
        <p style="color: #8e8e8e; font-size: 14px;">まだ投稿がありません</p>
      </div>
    <% end %>
  </div>
</div>